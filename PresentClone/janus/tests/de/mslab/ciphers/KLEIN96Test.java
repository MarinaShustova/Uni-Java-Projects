package de.mslab.ciphers;

import org.junit.AfterClass;
import org.junit.BeforeClass;
import org.junit.Test;

public class KLEIN96Test extends AbstractCipherTest {
	
	@BeforeClass
	public static void setUpBeforeClass() throws Exception {
		cipher = new KLEIN96();
	}
	
	@AfterClass
	public static void tearDownAfterClass() throws Exception {
		cipher = null;
	}
	
	@Test
	public void testDecrypt() {
		int[] key = { 0x12,0x34,0x56,0x78,0x90,0xAB,0xCD,0xEF,0x12,0x34,0x56,0x78 };
		int[] plaintext = { 0xFF,0xFF,0xFF,0xFF,0xFF,0xFF,0xFF,0xFF };
		int[] ciphertext = { 0x79,0x68,0x77,0x98,0xAF,0xDA,0x0B,0xC3 };
		testDecryption(key, plaintext, ciphertext);
	}
	
	@Test
	public void testDecryptEmptyKey() {
		int[] key = { 0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00 };
		int[] plaintext = { 0xFF,0xFF,0xFF,0xFF,0xFF,0xFF,0xFF,0xFF };
		int[] ciphertext = { 0xDB,0x9F,0xA7,0xD3,0x3D,0x8E,0x8E,0x36 };
		testDecryption(key, plaintext, ciphertext);
	}

	@Test
	public void testDecryptEmptyMessage() {
		int[] key = { 0xFF,0xFF,0xFF,0xFF,0xFF,0xFF,0xFF,0xFF,0xFF,0xFF,0xFF,0xFF };
		int[] plaintext = { 0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00 };
		int[] ciphertext = { 0x15,0xA3,0xA0,0x33,0x86,0xA7,0xFE,0xC6 };
		testDecryption(key, plaintext, ciphertext);
	}
	
	@Test
	public void testEncrypt() {
		int[] key = { 0x12,0x34,0x56,0x78,0x90,0xAB,0xCD,0xEF,0x12,0x34,0x56,0x78 };
		int[] plaintext = { 0xFF,0xFF,0xFF,0xFF,0xFF,0xFF,0xFF,0xFF };
		int[] ciphertext = { 0x79,0x68,0x77,0x98,0xAF,0xDA,0x0B,0xC3 };
		testEncryption(key, plaintext, ciphertext);
	}
	
	@Test
	public void testEncryptEmptyKey() {
		int[] key = { 0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00 };
		int[] plaintext = { 0xFF,0xFF,0xFF,0xFF,0xFF,0xFF,0xFF,0xFF };
		int[] ciphertext = { 0xDB,0x9F,0xA7,0xD3,0x3D,0x8E,0x8E,0x36 };
		testEncryption(key, plaintext, ciphertext);
	}

	@Test
	public void testEncryptEmptyMessage() {
		int[] key = { 0xFF,0xFF,0xFF,0xFF,0xFF,0xFF,0xFF,0xFF,0xFF,0xFF,0xFF,0xFF };
		int[] plaintext = { 0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00 };
		int[] ciphertext = { 0x15,0xA3,0xA0,0x33,0x86,0xA7,0xFE,0xC6 };
		testEncryption(key, plaintext, ciphertext);
	}
	
}
